(e=>{if(!e.WYSIWYG||!e.WYSIWYG.v2){let o={selector:".wysiwyg",height:360,maxHeight:750,placeholder:"Start typing...",sanitize:!0,autosaveKey:null,toolbar:["undo","redo","|","bold","italic","underline","strike","highlight","subscript","superscript","removeFormat","|","h1","h2","h3","h4","h5","h6","p","|","fontFamily","fontSize","lineHeight","fontColor","bgColor","|","alignLeft","alignCenter","alignRight","alignJustify","|","ul","ol","checklist","indent","outdent","|","link","image","video","table","hr","|","code","quote","collapsible","|","findReplace","wordCount","|","templates","insertSnippet","|","toggleSource","fullscreen"],collaboration:{enabled:!1,userId:null,userName:null,onComment:null,onMention:null},templates:[{name:"Meeting Notes",description:"Template for meeting minutes with agenda and action items",content:"<h2>📋 Meeting Notes</h2><p><strong>Date:</strong> "+(new Date).toLocaleDateString()+'</p><p><strong>Attendees:</strong></p><p><strong>Agenda:</strong></p><ul><li>Topic 1</li><li>Topic 2</li></ul><h3>Action Items</h3><ul class="wysiwyg-checklist"><li>Action item 1</li><li>Action item 2</li></ul>'},{name:"Article Template",description:"Professional article layout with title, introduction and sections",content:'<h1>📝 Article Title</h1><p style="font-size:18px;color:#6b7280;font-style:italic;">Write your compelling introduction here...</p><h2>Section 1</h2><p>Your content goes here...</p><h2>Section 2</h2><p>More content...</p><h2>Conclusion</h2><p>Wrap up your article...</p>'},{name:"Project Plan",description:"Project planning template with phases and tasks",content:'<h2>🚀 Project Plan</h2><p><strong>Project Name:</strong></p><p><strong>Timeline:</strong></p><div class="wysiwyg-collapsible"><div class="wysiwyg-collapsible-header">Phase 1: Planning</div><div class="wysiwyg-collapsible-content"><ul class="wysiwyg-checklist"><li>Requirement gathering</li><li>Timeline creation</li><li>Resource allocation</li></ul></div></div><div class="wysiwyg-collapsible"><div class="wysiwyg-collapsible-header">Phase 2: Implementation</div><div class="wysiwyg-collapsible-content"><ul class="wysiwyg-checklist"><li>Development tasks</li><li>Testing procedures</li></ul></div></div>'},{name:"Report Template",description:"Professional report structure with summary and findings",content:"<h1>📊 Report Title</h1><p><strong>Date:</strong> "+(new Date).toLocaleDateString()+"</p><p><strong>Prepared by:</strong></p><h2>Executive Summary</h2><p>Brief overview of key findings...</p><h2>Methodology</h2><p>Describe your approach...</p><h2>Findings</h2><p>Present your results...</p><h2>Recommendations</h2><ul><li>Recommendation 1</li><li>Recommendation 2</li></ul>"}],snippets:[{name:"💡 Tip Box",description:"Highlighted information box for tips and helpful hints",content:'<div style="background:#dbeafe;border-left:4px solid #3b82f6;padding:12px;border-radius:6px;margin:8px 0;">💡 <strong>Tip:</strong> Your helpful tip here</div>'},{name:"⚠️ Warning Box",description:"Attention-grabbing warning or caution message",content:'<div style="background:#fef3c7;border-left:4px solid #f59e0b;padding:12px;border-radius:6px;margin:8px 0;">⚠️ <strong>Warning:</strong> Important notice here</div>'},{name:"✅ Success Box",description:"Positive feedback or success message box",content:'<div style="background:#dcfce7;border-left:4px solid #22c55e;padding:12px;border-radius:6px;margin:8px 0;">✅ <strong>Success:</strong> Great job! Task completed.</div>'},{name:"📝 Quote Block",description:"Styled blockquote for important quotes or testimonials",content:'<blockquote style="border-left:4px solid #9ca3af;padding:12px 16px;margin:16px 0;background:#f9fafb;font-style:italic;"><p>"Your quote or testimonial here..."</p><footer style="margin-top:8px;font-size:14px;color:#6b7280;">— Source Name</footer></blockquote>'},{name:"📋 Checklist",description:"Interactive checklist for tasks and to-do items",content:'<h3>📋 Checklist</h3><ul class="wysiwyg-checklist"><li>Task 1</li><li>Task 2</li><li>Task 3</li></ul>'},{name:"📊 Simple Table",description:"Basic table structure for data presentation",content:'<table class="wysiwyg-table-advanced"><thead><tr><th>Column 1</th><th>Column 2</th><th>Column 3</th></tr></thead><tbody><tr><td>Data 1</td><td>Data 2</td><td>Data 3</td></tr><tr><td>Data 4</td><td>Data 5</td><td>Data 6</td></tr></tbody></table>'}],features:{dragDrop:!0,imageResize:!0,tableAdvanced:!0,wordCount:!0,findReplace:!0,spellCheck:!1,autoComplete:!1},uploadUrl:null,uploadFieldName:"image",uploadHeaders:{},onUploadProgress:null,parseUploadResponse:e=>e&&(e.url||e.data&&e.data.url)||null,uploadHandler:null,onWordCountUpdate:null,onContentChange:null,onSelectionChange:null,plugins:[]},i=[],t=null,c={bold:'<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M7 7h5a3 3 0 010 6H7zM7 13h6a3 3 0 110 6H7z"/></svg>',italic:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 4h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M6 20h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M15 4L9 20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',underline:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 3v7a7 7 0 0014 0V3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M4 21h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',strike:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',highlight:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 11H5l4-7 4 7h-4v7l-4-7z" fill="currentColor"/></svg>',subscript:'<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M3 7h6v2H3zM3 13h6v2H3zM15 21h4v-2h-4v-1h3a1 1 0 000-2h-3v2z"/><text x="12" y="12" font-size="8">X₂</text></svg>',superscript:'<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M3 7h6v2H3zM3 13h6v2H3zM15 9h4V7h-4V6h3a1 1 0 000-2h-3v2z"/><text x="12" y="8" font-size="8">X²</text></svg>',checklist:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" fill="none"/></svg>',collapsible:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',video:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="3" width="20" height="14" rx="2" stroke="currentColor" stroke-width="2"/><path d="M8 21h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M12 17v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><polygon points="10,8 16,12 10,16" fill="currentColor"/></svg>',findReplace:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',wordCount:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',templates:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 9h6v6H9z" stroke="currentColor" stroke-width="2"/></svg>',insertSnippet:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M8 6L2 12l6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 2v20" stroke="currentColor" stroke-width="1" stroke-linecap="round"/></svg>',alignJustify:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="2" rx="1" fill="currentColor"/><rect x="3" y="9" width="18" height="2" rx="1" fill="currentColor"/><rect x="3" y="14" width="18" height="2" rx="1" fill="currentColor"/></svg>',lineHeight:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M21 3v18" stroke="currentColor" stroke-width="1"/></svg>',undo:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 8H4V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M4 8a9 9 0 109 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',redo:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 8h5V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M20 8a9 9 0 11-9 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',removeFormat:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 7h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M12 3v14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',alignLeft:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="2" rx="1" fill="currentColor"/><rect x="3" y="9" width="12" height="2" rx="1" fill="currentColor"/><rect x="3" y="14" width="18" height="2" rx="1" fill="currentColor"/></svg>',alignCenter:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="2" rx="1" fill="currentColor"/><rect x="6" y="9" width="12" height="2" rx="1" fill="currentColor"/><rect x="3" y="14" width="18" height="2" rx="1" fill="currentColor"/></svg>',alignRight:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="2" rx="1" fill="currentColor"/><rect x="9" y="9" width="12" height="2" rx="1" fill="currentColor"/><rect x="3" y="14" width="18" height="2" rx="1" fill="currentColor"/></svg>',ul:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="6" cy="7" r="1.5" fill="currentColor"/><circle cx="6" cy="12" r="1.5" fill="currentColor"/><circle cx="6" cy="17" r="1.5" fill="currentColor"/><rect x="10" y="6" width="11" height="2" rx="1" fill="currentColor"/><rect x="10" y="11" width="11" height="2" rx="1" fill="currentColor"/><rect x="10" y="16" width="11" height="2" rx="1" fill="currentColor"/></svg>',ol:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><text x="2" y="8" font-size="7" fill="currentColor">1.</text><text x="2" y="13" font-size="7" fill="currentColor">2.</text><text x="2" y="18" font-size="7" fill="currentColor">3.</text><rect x="10" y="6" width="11" height="2" rx="1" fill="currentColor"/><rect x="10" y="11" width="11" height="2" rx="1" fill="currentColor"/><rect x="10" y="16" width="11" height="2" rx="1" fill="currentColor"/></svg>',indent:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="4" width="16" height="2" rx="1" fill="currentColor"/><rect x="8" y="9" width="12" height="2" rx="1" fill="currentColor"/><rect x="8" y="14" width="12" height="2" rx="1" fill="currentColor"/><path d="M3 11l3 3-3 3V11z" fill="currentColor"/></svg>',outdent:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="4" width="16" height="2" rx="1" fill="currentColor"/><rect x="4" y="9" width="12" height="2" rx="1" fill="currentColor"/><rect x="4" y="14" width="12" height="2" rx="1" fill="currentColor"/><path d="M21 11l-3 3 3 3V11z" fill="currentColor"/></svg>',link:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 14a5 5 0 007.07 0l3-3a5 5 0 00-7.07-7.07l-1 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M14 10a5 5 0 00-7.07 0l-3 3a5 5 0 007.07 7.07l1-1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',image:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><path d="M21 15l-5-5-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',table:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><path d="M3 9h18M3 15h18M9 3v18M15 3v18" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>',hr:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="11" width="18" height="2" rx="1" fill="currentColor"/></svg>',code:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M8 6L2 12l6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',quote:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 17h4v-6H7v6zM13 17h4v-6h-4v6z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>',toggleSource:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 16l-4-4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 8l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',fullscreen:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9V3h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M21 15v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M3 15v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M21 9V3h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',fontColor:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" fill="none"/><circle cx="12" cy="12" r="4" fill="currentColor"/></svg>',bgColor:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" fill="none"/><rect x="7" y="7" width="10" height="10" fill="currentColor"/></svg>',fontSize:'<svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><text x="2" y="16" font-size="12" fill="currentColor">A</text></svg>'};class s{constructor(e,t={}){this.element=e,this.options=Object.assign({},o,t),this.wrapper=null,this.toolbarEl=null,this.editorEl=null,this.sourceEl=null,this._buttons={},this._isInitialized=!1,this.init()}init(){var e,t;this._isInitialized||(document.getElementById("wysiwyg-v2-styles")||((e=document.createElement("style")).id="wysiwyg-v2-styles",e.textContent=`
.wysiwyg-wrapper{border:1px solid #e2e8f0;border-radius:8px;background:#fff;color:#111;font-family:Inter,system-ui,Arial;position:relative}
.wysiwyg-toolbar{display:flex;flex-wrap:wrap;gap:6px;padding:8px;background:#f8fafc;border-bottom:1px solid #eef2f7;scrollbar-width:none}
.wysiwyg-toolbar::-webkit-scrollbar{display:none}
.wysiwyg-toolbar button, .wysiwyg-toolbar select, .wysiwyg-toolbar input[type="color"]{background:transparent;border:1px solid #e6edf3;padding:6px 8px;border-radius:6px;cursor:pointer;transition:all 0.2s}
.wysiwyg-toolbar button:hover{background:#f1f3f4;border-color:#d1d5db}
.wysiwyg-toolbar button.active{background:#e3f2fd;border-color:#2196f3;color:#1976d2}
.wysiwyg-toolbar button{-webkit-tap-highlight-color:transparent}
.wysiwyg-toolbar button:focus-visible{outline:2px solid #94a3b8;outline-offset:2px}
.wysiwyg-toolbar button svg{display:block;width:16px;height:16px}
.wysiwyg-editor{min-height:120px;padding:14px;outline:none;color:inherit;word-break:break-word;overflow-y:auto;position:relative}
.wysiwyg-editor[contenteditable='true']{cursor:text}
.wysiwyg-source{width:100%;box-sizing:border-box;padding:10px;border:none;font-family:monospace;min-height:140px;overflow-y:auto}
.wysiwyg-hidden{display:none}
.wysiwyg-progress{height:6px;background:#f1f5f9;border-radius:6px;overflow:hidden;margin-top:6px}
.wysiwyg-progress > i{display:block;height:100%;width:0%;background:#2563eb;border-radius:6px}
.wysiwyg-dialog{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;border-radius:8px;padding:14px;border:1px solid #e6edf3;box-shadow:0 10px 30px rgba(2,6,23,0.08);z-index:9999;width:420px;max-width:92%}
.wysiwyg-dialog .row{margin-bottom:8px}
.wysiwyg-dialog label{display:block;font-size:13px;color:#334155;margin-bottom:6px}
.wysiwyg-dialog input[type=text], .wysiwyg-dialog textarea, .wysiwyg-dialog select{width:100%;padding:8px;border:1px solid #e6edf3;border-radius:6px}
.wysiwyg-fullscreen{position:fixed;inset:0;background:#fff;z-index:9998;padding:18px;overflow:auto;padding-left:calc(18px + env(safe-area-inset-left,0));padding-right:calc(18px + env(safe-area-inset-right,0));padding-top:calc(18px + env(safe-area-inset-top,0));padding-bottom:calc(18px + env(safe-area-inset-bottom,0))}

/* V2 Enhanced Features */
.wysiwyg-highlight{background-color:#ffeb3b;padding:0 2px}
.wysiwyg-checklist{list-style:none}
.wysiwyg-checklist li{position:relative;padding-left:24px}
.wysiwyg-checklist li:before{content:'☐';position:absolute;left:0;top:0;font-size:16px;cursor:pointer}
.wysiwyg-checklist li.checked:before{content:'☑'}
.wysiwyg-collapsible{border:1px solid #e2e8f0;border-radius:6px;margin:8px 0}
.wysiwyg-collapsible-header{background:#f8fafc;padding:8px 12px;cursor:pointer;border-bottom:1px solid #e2e8f0;font-weight:500}
.wysiwyg-collapsible-content{padding:12px;display:none}
.wysiwyg-collapsible.open .wysiwyg-collapsible-content{display:block}
.wysiwyg-word-count{position:absolute;bottom:8px;right:12px;font-size:12px;color:#6b7280;background:rgba(255,255,255,0.9);padding:2px 6px;border-radius:4px}
.wysiwyg-find-replace{position:absolute;top:8px;right:8px;background:#fff;border:1px solid #e2e8f0;border-radius:6px;padding:12px;box-shadow:0 4px 12px rgba(0,0,0,0.1);z-index:1000;min-width:320px;display:flex;flex-wrap:wrap;align-items:center;gap:4px}
.wysiwyg-find-replace input{width:140px;padding:6px 8px;border:1px solid #d1d5db;border-radius:4px;font-size:13px}
.wysiwyg-find-replace input:focus{outline:2px solid #3b82f6;outline-offset:1px;border-color:#3b82f6}
.wysiwyg-find-replace button{padding:6px 10px;border:1px solid #d1d5db;border-radius:4px;background:#fff;cursor:pointer;font-size:12px;font-weight:500;transition:all 0.2s}
.wysiwyg-find-replace button:hover{background:#f1f3f4;border-color:#9ca3af}
.wysiwyg-find-replace button:active{background:#e5e7eb}
.wysiwyg-find-replace #close-find{background:#ef4444;color:#fff;border-color:#ef4444;width:24px;height:24px;padding:0;display:flex;align-items:center;justify-content:center;font-size:14px;line-height:1}
.wysiwyg-find-replace #close-find:hover{background:#dc2626}
.wysiwyg-find-replace #find-status{font-size:11px;color:#6b7280;white-space:nowrap}
.wysiwyg-templates-panel{position:absolute;top:45px;left:8px;background:#fff;border:1px solid #e2e8f0;border-radius:6px;padding:8px;box-shadow:0 4px 12px rgba(0,0,0,0.1);z-index:1000;max-width:300px}
.wysiwyg-template-item{padding:8px 12px;cursor:pointer;border-radius:4px;margin:2px 0}
.wysiwyg-template-item:hover{background:#f1f3f4}
.wysiwyg-image-resize{position:absolute;width:8px;height:8px;background:#2196f3;border:1px solid #fff;border-radius:2px;cursor:nw-resize}
.wysiwyg-video-wrapper{position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:6px;margin:8px 0}
.wysiwyg-video-wrapper iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}

/* Enhanced table styles */
.wysiwyg-table-advanced{border-collapse:collapse;width:100%;margin:8px 0}
.wysiwyg-table-advanced th,.wysiwyg-table-advanced td{border:1px solid #e2e8f0;padding:8px 12px;text-align:left}
.wysiwyg-table-advanced th{background:#f8fafc;font-weight:600}
.wysiwyg-table-advanced tr:nth-child(even){background:#fafbfc}
.wysiwyg-table-controls{position:absolute;background:#fff;border:1px solid #e2e8f0;border-radius:6px;padding:8px;box-shadow:0 4px 12px rgba(0,0,0,0.1);z-index:1000}
.wysiwyg-table-controls button{padding:4px 8px;margin:2px;border:1px solid #d1d5db;border-radius:4px;background:#fff;cursor:pointer}

/* Enhanced tooltips */
.wysiwyg-toolbar button[title]:hover::after, .wysiwyg-toolbar select[title]:hover::after, .wysiwyg-toolbar input[title]:hover::after {
  content: attr(title);
  position: absolute;
  bottom: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  background: #1f2937;
  color: #f9fafb;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 12px;
  white-space: nowrap;
  z-index: 10000;
  max-width: 250px;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  pointer-events: none;
}

.wysiwyg-toolbar button[title]:hover::before, .wysiwyg-toolbar select[title]:hover::before, .wysiwyg-toolbar input[title]:hover::before {
  content: '';
  position: absolute;
  bottom: calc(100% + 2px);
  left: 50%;
  transform: translateX(-50%);
  border: 4px solid transparent;
  border-top-color: #1f2937;
  z-index: 10000;
  pointer-events: none;
}

/* Enhanced dialog tooltips */
.wysiwyg-dialog input[title]:hover::after, .wysiwyg-dialog button[title]:hover::after, .wysiwyg-dialog label[title]:hover::after {
  content: attr(title);
  position: absolute;
  top: calc(100% + 8px);
  left: 0;
  background: #1f2937;
  color: #f9fafb;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 12px;
  white-space: nowrap;
  z-index: 10001;
  max-width: 200px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  pointer-events: none;
}

/* Mobile/touch optimizations */
@media (max-width: 640px), (pointer: coarse) {
  .wysiwyg-toolbar{position:sticky;top:calc(env(safe-area-inset-top,0));z-index:1000;flex-wrap:nowrap;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;gap:4px;padding:8px 6px}
  .wysiwyg-toolbar button, .wysiwyg-toolbar select, .wysiwyg-toolbar input[type="color"]{min-width:40px;min-height:40px;padding:8px !important}
  .wysiwyg-dialog{inset:env(safe-area-inset-top,0) env(safe-area-inset-right,0) env(safe-area-inset-bottom,0) env(safe-area-inset-left,0);left:auto;top:auto;transform:none;width:auto;max-width:100%;height:auto;max-height:100%;border-radius:0}
  .wysiwyg-find-replace{position:relative;top:auto;right:auto;margin:8px 0}
  .wysiwyg-templates-panel{position:relative;top:auto;left:auto;margin:8px 0;max-width:100%}
  
  /* Hide tooltips on mobile for better touch experience */
  .wysiwyg-toolbar button[title]:hover::after, .wysiwyg-toolbar select[title]:hover::after, .wysiwyg-toolbar input[title]:hover::after,
  .wysiwyg-toolbar button[title]:hover::before, .wysiwyg-toolbar select[title]:hover::before, .wysiwyg-toolbar input[title]:hover::before,
  .wysiwyg-dialog input[title]:hover::after, .wysiwyg-dialog button[title]:hover::after, .wysiwyg-dialog label[title]:hover::after {
    display: none;
  }
}
`,document.head.appendChild(e)),this.buildEditor(),this.setupEvents(),(t=this)._history=[],t._historyIndex=-1,t._lastSnapshot="",t._saveSnapshot=function(){var e=t.editorEl.innerHTML;e!==t._lastSnapshot&&(t._historyIndex++,t._history=t._history.slice(0,t._historyIndex),t._history.push(e),t._lastSnapshot=e,50<t._history.length)&&(t._history.shift(),t._historyIndex--)},t._undo=function(){0<t._historyIndex&&(t._historyIndex--,t.editorEl.innerHTML=t._history[t._historyIndex],t._lastSnapshot=t._history[t._historyIndex],t.editorEl.focus())},t._redo=function(){t._historyIndex<t._history.length-1&&(t._historyIndex++,t.editorEl.innerHTML=t._history[t._historyIndex],t._lastSnapshot=t._history[t._historyIndex],t.editorEl.focus())},setTimeout(()=>t._saveSnapshot(),100),this.options.autosaveKey&&(this.loadAutosave(),this.setupAutosave()),this.options.features.wordCount&&p(this),this.options.plugins.forEach(e=>{"function"==typeof e&&e(this)}),this._isInitialized=!0,i.push(this))}buildEditor(){this.wrapper=document.createElement("div"),this.wrapper.className="wysiwyg-wrapper",this.toolbarEl=a(this.options.toolbar,this),this.wrapper.appendChild(this.toolbarEl),this.editorEl=document.createElement("div"),this.editorEl.className="wysiwyg-editor",this.editorEl.contentEditable=!0,this.editorEl.setAttribute("role","textbox"),this.editorEl.setAttribute("aria-multiline","true"),this.editorEl.setAttribute("aria-label","Rich text editor");var e=this.element.value||this.element.innerHTML||"";this.editorEl.innerHTML=e,this.options.height&&(this.editorEl.style.height=this.options.height+"px"),this.options.maxHeight&&(this.editorEl.style.maxHeight=this.options.maxHeight+"px",this.editorEl.style.overflowY="auto"),this.options.placeholder&&!e&&(this.editorEl.setAttribute("data-placeholder",this.options.placeholder),this.addPlaceholderCSS()),this.wrapper.appendChild(this.editorEl),this.element.style.display="none",this.element.parentNode.insertBefore(this.wrapper,this.element.nextSibling)}addPlaceholderCSS(){let e=document.getElementById("wysiwyg-v2-placeholder");e||((e=document.createElement("style")).id="wysiwyg-v2-placeholder",document.head.appendChild(e)),e.textContent=`
        .wysiwyg-editor[data-placeholder]:empty:before {
          content: attr(data-placeholder);
          color: #9ca3af;
          pointer-events: none;
          position: absolute;
        }
      `}setupEvents(){var e;this.editorEl.addEventListener("input",()=>{this.updateOriginalElement(),this.options.features.wordCount&&(clearTimeout(t),t=setTimeout(()=>p(this),300)),"function"==typeof this.options.onContentChange&&this.options.onContentChange(this.getContent(),this)}),this.editorEl.addEventListener("paste",e=>{this.options.sanitize&&(e.preventDefault(),g("insertHTML",l((e.clipboardData||window.clipboardData).getData("text/html")||(e.clipboardData||window.clipboardData).getData("text/plain"))),this._saveSnapshot)&&this._saveSnapshot()}),this.editorEl.addEventListener("keyup",()=>{setTimeout(()=>v(this),10),"function"==typeof this.options.onSelectionChange&&this.options.onSelectionChange(window.getSelection(),this)}),this.editorEl.addEventListener("mouseup",()=>{setTimeout(()=>v(this),10),"function"==typeof this.options.onSelectionChange&&this.options.onSelectionChange(window.getSelection(),this)}),this.editorEl.addEventListener("keydown",e=>{if("Enter"!==e.key&&"Backspace"!==e.key&&"Delete"!==e.key||!this._saveSnapshot||setTimeout(()=>this._saveSnapshot(),10),e.ctrlKey||e.metaKey)switch(e.key.toLowerCase()){case"z":e.shiftKey?(e.preventDefault(),this._redo()):(e.preventDefault(),this._undo());break;case"y":e.preventDefault(),this._redo();break;case"k":e.preventDefault(),h(this);break;case"f":e.preventDefault(),w(this)}}),this.options.placeholder&&(this.editorEl.addEventListener("input",e=()=>{""===this.editorEl.innerHTML.trim()||"<br>"===this.editorEl.innerHTML?this.editorEl.setAttribute("data-placeholder",this.options.placeholder):this.editorEl.removeAttribute("data-placeholder")}),this.editorEl.addEventListener("focus",e),this.editorEl.addEventListener("blur",e),e()),this.options.features.imageResize&&this.setupImageResize(),this.options.features.dragDrop&&this.setupDragDrop()}setupImageResize(){this.editorEl.addEventListener("click",e=>{"IMG"===e.target.tagName&&this.selectImage(e.target)})}selectImage(e){this.wrapper.querySelectorAll(".wysiwyg-image-resize").forEach(e=>e.remove());var e=e.getBoundingClientRect(),t=this.wrapper.getBoundingClientRect(),o=document.createElement("div");o.className="wysiwyg-image-resize",o.style.left=e.right-t.left-4+"px",o.style.top=e.bottom-t.top-4+"px",this.wrapper.appendChild(o)}setupDragDrop(){this.editorEl.addEventListener("dragover",e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy"}),this.editorEl.addEventListener("drop",e=>{e.preventDefault(),Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/")).forEach(e=>{var t;this.options.uploadHandler?this.options.uploadHandler(e,e=>{e&&(g("insertHTML",`<img src="${e}" style="max-width:100%;height:auto;border-radius:4px;">`),this._saveSnapshot)&&this._saveSnapshot()}):((t=new FileReader).onload=e=>{g("insertHTML",`<img src="${e.target.result}" style="max-width:100%;height:auto;border-radius:4px;">`),this._saveSnapshot&&this._saveSnapshot()},t.readAsDataURL(e))})})}setupAutosave(){let e;this.editorEl.addEventListener("input",()=>{clearTimeout(e),e=setTimeout(()=>{localStorage.setItem(this.options.autosaveKey,this.getContent())},1e3)})}loadAutosave(){var e=localStorage.getItem(this.options.autosaveKey);e&&!this.editorEl.innerHTML.trim()&&this.setContent(e)}getContent(){return this.options.sanitize?l(this.editorEl.innerHTML):this.editorEl.innerHTML}setContent(e){this.editorEl.innerHTML=this.options.sanitize?l(e):e,this.updateOriginalElement(),this._saveSnapshot&&this._saveSnapshot()}getText(){return this.editorEl.innerText||this.editorEl.textContent||""}updateOriginalElement(){var e=this.getContent();"TEXTAREA"===this.element.tagName||"INPUT"===this.element.tagName?this.element.value=e:this.element.innerHTML=e}focus(){this.editorEl.focus()}blur(){this.editorEl.blur()}disable(){this.editorEl.contentEditable=!1,this.toolbarEl.style.pointerEvents="none",this.toolbarEl.style.opacity="0.5"}enable(){this.editorEl.contentEditable=!0,this.toolbarEl.style.pointerEvents="",this.toolbarEl.style.opacity=""}destroy(){var e=i.indexOf(this);-1<e&&i.splice(e,1),this.element.style.display="",this.updateOriginalElement(),this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.options.autosaveKey&&localStorage.removeItem(this.options.autosaveKey)}addPlugin(e){"function"==typeof e&&e(this)}}let n={init:function(e,o={}){e="string"==typeof e?document.querySelectorAll(e):void 0!==e.length?e:[e];let i=[];return Array.from(e).forEach(e=>{var t;e.dataset.wysiwygV2||(t=new s(e,o),e.dataset.wysiwygV2="true",i.push(t))}),1===i.length?i[0]:i},sanitize:l,instances:()=>i.slice(),version:"0.2.0"};var r=n;function l(e){for(var t=document.createElement("div"),o=(t.innerHTML=e,t.querySelectorAll('script,style,iframe[src*="javascript:"],object,embed,link[rel!="noopener"],meta').forEach(e=>e.remove()),t.querySelectorAll("iframe").forEach(e=>{let t=e.src.toLowerCase();["youtube.com","youtu.be","vimeo.com","dailymotion.com"].some(e=>t.includes(e))||e.remove()}),document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null)),i=[];o.nextNode();)i.push(o.currentNode);return i.forEach(i=>{if(Array.from(i.attributes||[]).forEach(e=>{var t=e.name.toLowerCase(),o=(e.value||"").toLowerCase();(t.startsWith("on")||"href"===t&&o.startsWith("javascript:"))&&i.removeAttribute(e.name)}),i.className){let t=["wysiwyg-highlight","wysiwyg-checklist","wysiwyg-collapsible","wysiwyg-collapsible-header","wysiwyg-collapsible-content","wysiwyg-table-advanced"];var e=i.className.split(" ").filter(e=>t.includes(e));i.className=e.join(" ")}}),t.innerHTML}function g(t,e=null){try{document.execCommand(t,!1,e)}catch(e){console.warn("execCommand failed",t,e)}}function p(t){if(t.options.features.wordCount){var o=t.editorEl.innerText||"",o=(o=o)&&o.trim()?{words:o.trim().split(/\s+/).filter(e=>0<e.length).length,characters:o.length,charactersNoSpaces:o.replace(/\s/g,"").length}:{words:0,characters:0,charactersNoSpaces:0};let e=t.wrapper.querySelector(".wysiwyg-word-count");e||((e=document.createElement("div")).className="wysiwyg-word-count",t.wrapper.appendChild(e)),e.textContent=o.words+` words, ${o.characters} chars`;var i=Math.ceil(o.words/200);e.title=`Writing Statistics:
• Words: ${o.words}
• Characters: ${o.characters}
• Characters (no spaces): ${o.charactersNoSpaces}
• Estimated reading time: ${i} minute`+(1!==i?"s":""),"function"==typeof t.options.onWordCountUpdate&&t.options.onWordCountUpdate(o,t)}}function a(e,u){let l=document.createElement("div"),a=(l.className="wysiwyg-toolbar",u._buttons={},(e,t,o,i={})=>{var r=document.createElement("button"),n=(r.type="button",r.dataset.cmd=e,r.title=i.title||t||e,r.setAttribute("aria-pressed","false"),r._originalTooltip=i.title||t||e,r._activeTooltip=i.activeTitle||null,u&&u.options&&u.options.icons&&u.options.icons[e]||c[e]);return n?(r.innerHTML=n,r.style.display="inline-flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.width=i.width||"36px",r.style.height=i.height||"36px",r.style.padding="6px"):r.textContent=t||e,r.addEventListener("click",e=>{try{o(e)}catch(e){console.error("toolbar handler error",e)}u&&setTimeout(()=>v(u),10)}),l.appendChild(r),u._buttons[e]=r}),s=(e,t,o={})=>{let i=document.createElement("select");return o.title&&(i.title=o.title),e.forEach(e=>{var t=document.createElement("option");t.value=e.value,t.textContent=e.label,i.appendChild(t)}),i.addEventListener("change",e=>t(e.target.value)),l.appendChild(i),i},d=(t,e="Color")=>{var o=document.createElement("input");return o.type="color",o.title=e,o.addEventListener("input",e=>t(e.target.value)),l.appendChild(o),o};return e.forEach(e=>{var t,o,i,r,n;if("|"===e)(t=document.createElement("div")).style.width="8px",l.appendChild(t);else switch(e){case"undo":a("undo","Undo",()=>{u&&"function"==typeof u._undo?u._undo():g("undo")},{title:"Undo last action (Ctrl/Cmd+Z)"});break;case"redo":a("redo","Redo",()=>{u&&"function"==typeof u._redo?u._redo():g("redo")},{title:"Redo last undone action (Shift+Ctrl/Cmd+Z)"});break;case"bold":a("bold","Bold",()=>{g("bold"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Make selected text bold (Ctrl/Cmd+B)",activeTitle:"Remove bold formatting from selected text (Ctrl/Cmd+B)"});break;case"italic":a("italic","Italic",()=>{g("italic"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Make selected text italic (Ctrl/Cmd+I)",activeTitle:"Remove italic formatting from selected text (Ctrl/Cmd+I)"});break;case"underline":a("underline","Underline",()=>{g("underline"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Underline selected text (Ctrl/Cmd+U)",activeTitle:"Remove underline from selected text (Ctrl/Cmd+U)"});break;case"strike":a("strike","Strike",()=>{g("strikeThrough"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Strike through selected text"});break;case"highlight":a("highlight","Highlight",()=>{var e="span",t="wysiwyg-highlight",o=u,i=window.getSelection();if(0!==i.rangeCount){i=i.getRangeAt(0);if(!i.collapsed){e=document.createElement(e);t&&(e.className=t);try{i.surroundContents(e),o&&o._saveSnapshot&&o._saveSnapshot()}catch(e){console.warn("Could not wrap selection:",e)}}}},{title:"Highlight selected text with yellow background"});break;case"subscript":a("subscript","Subscript",()=>{g("subscript"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Format as subscript (H₂O, chemical formulas)"});break;case"superscript":a("superscript","Superscript",()=>{g("superscript"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Format as superscript (E=mc², exponents)"});break;case"removeFormat":a("removeFormat","Remove format",()=>{g("removeFormat"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Remove all formatting from selected text"});break;case"h1":a("h1","H1",()=>{g("formatBlock","H1"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Large heading - Main title (H1)"});break;case"h2":a("h2","H2",()=>{g("formatBlock","H2"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Section heading - Major section (H2)"});break;case"h3":a("h3","H3",()=>{g("formatBlock","H3"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Subsection heading (H3)"});break;case"h4":a("h4","H4",()=>{g("formatBlock","H4"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Minor heading (H4)"});break;case"h5":a("h5","H5",()=>{g("formatBlock","H5"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Small heading (H5)"});break;case"h6":a("h6","H6",()=>{g("formatBlock","H6"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Smallest heading (H6)"});break;case"p":a("p","P",()=>{g("formatBlock","P"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Normal paragraph text"});break;case"fontFamily":s([{value:"",label:"Font family"},{value:"Inter",label:"Inter"},{value:"Arial",label:"Arial"},{value:"Helvetica",label:"Helvetica"},{value:"Times New Roman",label:"Times New Roman"},{value:"Georgia",label:"Georgia"},{value:"Verdana",label:"Verdana"},{value:"Tahoma",label:"Tahoma"},{value:"Trebuchet MS",label:"Trebuchet MS"},{value:"Courier New",label:"Courier New"},{value:"Roboto",label:"Roboto"},{value:"Monospace",label:"Monospace"}],e=>{e&&(g("fontName",e),u)&&u._saveSnapshot&&u._saveSnapshot()},{title:"Change font family - Choose from modern and classic fonts"});break;case"fontSize":s([{value:"",label:"Font size"},{value:"1",label:"Small"},{value:"2",label:"Smaller"},{value:"3",label:"Normal"},{value:"4",label:"Medium"},{value:"5",label:"Large"},{value:"6",label:"Larger"},{value:"7",label:"Huge"}],e=>{g("fontSize",e||3),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Change font size - From small to huge"});break;case"lineHeight":s([{value:"",label:"Line height"},{value:"1.0",label:"Single"},{value:"1.15",label:"1.15"},{value:"1.5",label:"1.5"},{value:"2.0",label:"Double"},{value:"2.5",label:"2.5"},{value:"3.0",label:"Triple"}],e=>{var t,o;e&&(e=e,t=u,0!==(o=window.getSelection()).rangeCount)&&(((o=o.getRangeAt(0).commonAncestorContainer).nodeType===Node.TEXT_NODE?o.parentElement:o).style.lineHeight=e,t)&&t._saveSnapshot&&t._saveSnapshot()},{title:"Adjust line spacing - Single to triple spacing"});break;case"fontColor":d(e=>{g("foreColor",e),u&&u._saveSnapshot&&u._saveSnapshot()},"Change text color - Click to open color picker");break;case"bgColor":d(e=>{g("hiliteColor",e),u&&u._saveSnapshot&&u._saveSnapshot()},"Change background color - Highlight text background");break;case"alignLeft":a("alignLeft","Align left",()=>{g("justifyLeft"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Align text to the left margin"});break;case"alignCenter":a("alignCenter","Align center",()=>{g("justifyCenter"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Center text horizontally"});break;case"alignRight":a("alignRight","Align right",()=>{g("justifyRight"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Align text to the right margin"});break;case"alignJustify":a("alignJustify","Justify",()=>{g("justifyFull"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Justify text - align to both margins"});break;case"ul":a("ul","Bulleted list",()=>{g("insertUnorderedList"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Create bulleted list - Unordered list with dots"});break;case"ol":a("ol","Numbered list",()=>{g("insertOrderedList"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Create numbered list - Ordered list with numbers"});break;case"checklist":a("checklist","Checklist",()=>{var o=u;g("insertHTML",`
      <ul class="wysiwyg-checklist">
        <li>First item</li>
        <li>Second item</li>
        <li>Third item</li>
      </ul>
    `),o&&o._saveSnapshot&&o._saveSnapshot(),setTimeout(()=>{o.editorEl.querySelectorAll(".wysiwyg-checklist li").forEach(t=>{t.addEventListener("click",e=>{e.target===t&&(t.classList.toggle("checked"),o)&&o._saveSnapshot&&o._saveSnapshot()})})},100)},{title:"Insert interactive checklist - Clickable checkboxes for tasks"});break;case"indent":a("indent","Indent",()=>{g("indent"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Increase indent - Move text further right"});break;case"outdent":a("outdent","Outdent",()=>{g("outdent"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Decrease indent - Move text further left"});break;case"link":a("link","Link",()=>h(u),{title:"Insert hyperlink - Link to websites or pages (Ctrl/Cmd+K)"});break;case"image":a("image","Image",()=>{{var a=u;let o=document.createElement("div"),l=(o.className="wysiwyg-dialog",o.innerHTML=`
      <h3>Insert Image</h3>
      <div class="row">
        <label>Image URL:</label>
        <input type="text" id="img-url" placeholder="https://example.com/image.jpg" title="Enter the web address (URL) of an image, or upload a file below">
      </div>
      <div class="row">
        <label>Alt text:</label>
        <input type="text" id="img-alt" placeholder="Describe the image" title="Alternative text for accessibility - describes the image for screen readers">
      </div>
      <div class="row">
        <label>Upload file:</label>
        <input type="file" id="img-file" accept="image/*" title="Choose an image file from your computer (JPG, PNG, GIF, etc.)">
      </div>
      <div class="row" style="text-align:right;margin-top:12px;">
        <button type="button" onclick="this.closest('.wysiwyg-dialog').remove()" title="Cancel and close without inserting image">Cancel</button>
        <button type="button" id="insert-img" style="margin-left:8px;" title="Insert the image into your content">Insert</button>
      </div>
    `,document.body.appendChild(o),o.querySelector("#img-url")),i=o.querySelector("#img-alt"),e=o.querySelector("#img-file");l.focus(),e.addEventListener("change",e=>{e=e.target.files[0];if(e)if(a.options.uploadHandler)a.options.uploadHandler(e,e=>{e&&(l.value=e)});else if(a.options.uploadUrl){var t=e,i=a,r=e=>{e&&(l.value=e)};if(i.options.uploadUrl){var n=new FormData;n.append(i.options.uploadFieldName||"image",t);let o=new XMLHttpRequest;o.upload.addEventListener("progress",e=>{e.lengthComputable&&i.options.onUploadProgress&&(e=e.loaded/e.total*100,i.options.onUploadProgress(e,i))}),o.addEventListener("load",()=>{if(200===o.status)try{var e=JSON.parse(o.responseText),t=i.options.parseUploadResponse(e);r(t)}catch(e){console.error("Upload response parse error:",e),r(null)}else r(null)}),o.addEventListener("error",()=>{r(null)}),o.open("POST",i.options.uploadUrl),Object.keys(i.options.uploadHeaders||{}).forEach(e=>{o.setRequestHeader(e,i.options.uploadHeaders[e])}),o.send(n)}else r(null)}else{t=new FileReader;t.onload=e=>{l.value=e.target.result},t.readAsDataURL(e)}}),o.querySelector("#insert-img").addEventListener("click",()=>{var e=l.value.trim(),t=i.value.trim();e&&(a.editorEl.focus(),g("insertHTML",`<img src="${e}" alt="${t}" style="max-width:100%;height:auto;border-radius:4px;">`),a._saveSnapshot)&&a._saveSnapshot(),o.remove()})}},{title:"Insert image - Upload or embed pictures from URL"});break;case"video":a("video","Video",()=>{{var a=u;let i=document.createElement("div"),r=(i.className="wysiwyg-dialog",i.innerHTML=`
      <h3>Insert Video</h3>
      <div class="row">
        <label>Video URL (YouTube, Vimeo, etc.):</label>
        <input type="text" id="video-url" placeholder="https://www.youtube.com/watch?v=..." title="Paste the URL from YouTube, Vimeo, or other supported video platforms">
      </div>
      <div class="row">
        <label>Width (optional):</label>
        <input type="text" id="video-width" placeholder="560" value="560" title="Video width in pixels (default: 560px)">
      </div>
      <div class="row">
        <label>Height (optional):</label>
        <input type="text" id="video-height" placeholder="315" value="315" title="Video height in pixels (default: 315px)">
      </div>
      <div class="row" style="text-align:right;margin-top:12px;">
        <button type="button" onclick="this.closest('.wysiwyg-dialog').remove()" title="Cancel and close without inserting video">Cancel</button>
        <button type="button" id="insert-video" style="margin-left:8px;" title="Embed the video into your content">Insert</button>
      </div>
    `,document.body.appendChild(i),i.querySelector("#video-url")),n=i.querySelector("#video-width"),l=i.querySelector("#video-height");r.focus(),i.querySelector("#insert-video").addEventListener("click",()=>{var e=r.value.trim(),t=n.value.trim()||"560",o=l.value.trim()||"315";e&&((e=(e=>{var t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return t?"https://www.youtube.com/embed/"+t[1]:(t=e.match(/vimeo\.com\/(\d+)/))?"https://player.vimeo.com/video/"+t[1]:e.includes("/embed/")||e.includes("player.")?e:null})(e))?(a.editorEl.focus(),g("insertHTML",`
            <div class="wysiwyg-video-wrapper">
              <iframe src="${e}" width="${t}" height="${o}" frameborder="0" allowfullscreen></iframe>
            </div>
          `),a._saveSnapshot&&a._saveSnapshot()):alert("Please enter a valid YouTube, Vimeo, or other supported video URL")),i.remove()})}},{title:"Embed video - YouTube, Vimeo, and other platforms"});break;case"table":a("table","Table",()=>{{var h=u;let a=document.createElement("div"),s=(a.className="wysiwyg-dialog",a.innerHTML=`
      <h3>Insert Table</h3>
      <div class="row">
        <label>Rows:</label>
        <input type="number" id="table-rows" min="1" max="50" value="3" title="Number of table rows (1-50)">
      </div>
      <div class="row">
        <label>Columns:</label>
        <input type="number" id="table-cols" min="1" max="20" value="3" title="Number of table columns (1-20)">
      </div>
      <div class="row">
        <label title="Add a header row with bold text and different background">
          <input type="checkbox" id="table-header" checked> Include header row
        </label>
      </div>
      <div class="row">
        <label title="Alternate row colors for better readability">
          <input type="checkbox" id="table-striped"> Striped rows
        </label>
      </div>
      <div class="row" style="text-align:right;margin-top:12px;">
        <button type="button" onclick="this.closest('.wysiwyg-dialog').remove()" title="Cancel and close without inserting table">Cancel</button>
        <button type="button" id="insert-table" style="margin-left:8px;" title="Create and insert the table with your settings">Insert</button>
      </div>
    `,document.body.appendChild(a),a.querySelector("#table-rows")),d=a.querySelector("#table-cols"),c=a.querySelector("#table-header"),p=a.querySelector("#table-striped");s.focus(),a.querySelector("#insert-table").addEventListener("click",()=>{var e=parseInt(s.value)||3,o=parseInt(d.value)||3,t=c.checked;let i="wysiwyg-table-advanced",r=(p.checked&&(i+=" striped"),`<table class="${i}">`);if(t){r+="<thead><tr>";for(let e=0;e<o;e++)r+=`<th>Header ${e+1}</th>`;r+="</tr></thead>"}r+="<tbody>";var n=t?1:0,l=e;for(let t=n;t<l+n;t++){r+="<tr>";for(let e=0;e<o;e++)r+=`<td>Cell ${t+1},${e+1}</td>`;r+="</tr>"}r+="</tbody></table>",h.editorEl.focus(),g("insertHTML",r),h._saveSnapshot&&h._saveSnapshot(),a.remove()})}},{title:"Insert table - Custom rows, columns, and styling"});break;case"hr":a("hr","HR",()=>{g("insertHorizontalRule"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Insert horizontal line - Visual separator"});break;case"code":a("code","Code",()=>{var e=u,t=window.getSelection(),o=t.toString();o?(g("formatBlock","pre"),(o=t.getRangeAt(0).commonAncestorContainer.closest("pre"))&&(o.style.background="#f6f8fa",o.style.padding="12px",o.style.borderRadius="6px",o.style.fontFamily="monospace",o.style.fontSize="14px",o.style.overflow="auto")):g("insertHTML",'<pre style="background:#f6f8fa;padding:12px;border-radius:6px;font-family:monospace;font-size:14px;overflow:auto;">// Your code here</pre>'),e&&e._saveSnapshot&&e._saveSnapshot()},{title:"Insert code block - Formatted code with syntax highlighting"});break;case"quote":a("quote","Quote",()=>{g("formatBlock","BLOCKQUOTE"),u&&u._saveSnapshot&&u._saveSnapshot()},{title:"Format as blockquote - Indented quote text"});break;case"collapsible":a("collapsible","Collapsible",()=>{{var o=u;let t="collapse-"+Math.random().toString(36).slice(2,9),e=`
      <div class="wysiwyg-collapsible" data-id="${t}">
        <div class="wysiwyg-collapsible-header">Click to expand</div>
        <div class="wysiwyg-collapsible-content">
          <p>Collapsible content goes here...</p>
        </div>
      </div>
    `;g("insertHTML",e),o&&o._saveSnapshot&&o._saveSnapshot(),setTimeout(()=>{let e=o.editorEl.querySelector(`[data-id="${t}"]`);e&&e.querySelector(".wysiwyg-collapsible-header").addEventListener("click",()=>{e.classList.toggle("open")})},100)}},{title:"Insert collapsible section - Expandable content area"});break;case"findReplace":a("findReplace","Find & Replace",()=>w(u),{title:"Find and replace text - Search through content (Ctrl/Cmd+F)"});break;case"wordCount":a("wordCount","Word Count",()=>{var e;(e=u).options.features.wordCount=!e.options.features.wordCount,e.options.features.wordCount?p(e):(e=e.wrapper.querySelector(".wysiwyg-word-count"))&&e.remove()},{title:"Toggle word count display - Show writing statistics"});break;case"templates":a("templates","Templates",()=>{{var i=u;let o=i.wrapper.querySelector(".wysiwyg-templates-panel");o?o.remove():((o=document.createElement("div")).className="wysiwyg-templates-panel",i.options.templates&&0!==i.options.templates.length?(o.innerHTML='<h4 title="Choose a pre-made template to insert into your content">Templates</h4>',i.options.templates.forEach(e=>{var t=document.createElement("div");t.className="wysiwyg-template-item",t.textContent=e.name,t.title=`Insert "${e.name}" template - `+(e.description||"Pre-formatted content block"),t.addEventListener("click",()=>{i.editorEl.focus(),g("insertHTML",e.content),i._saveSnapshot&&i._saveSnapshot(),o.remove()}),o.appendChild(t)})):o.innerHTML="<p>No templates available</p>",i.wrapper.appendChild(o))}},{title:"Insert content template - Pre-made layouts and formats"});break;case"insertSnippet":a("insertSnippet","Snippet",()=>{{var i=u;let o=i.wrapper.querySelector(".wysiwyg-snippets-panel");o?o.remove():((o=document.createElement("div")).className="wysiwyg-templates-panel wysiwyg-snippets-panel",i.options.snippets&&0!==i.options.snippets.length?(o.innerHTML='<h4 title="Insert quick reusable content blocks and components">Snippets</h4>',i.options.snippets.forEach(e=>{var t=document.createElement("div");t.className="wysiwyg-template-item",t.textContent=e.name,t.title=`Insert "${e.name}" snippet - `+(e.description||"Quick content block"),t.addEventListener("click",()=>{i.editorEl.focus(),g("insertHTML",e.content),i._saveSnapshot&&i._saveSnapshot(),o.remove()}),o.appendChild(t)})):o.innerHTML="<p>No snippets available</p>",i.wrapper.appendChild(o))}},{title:"Insert code snippet - Quick reusable content blocks"});break;case"toggleSource":a("toggleSource","Source",()=>{var e=u;e.sourceEl||(e.sourceEl=document.createElement("textarea"),e.sourceEl.className="wysiwyg-source wysiwyg-hidden",e.wrapper.appendChild(e.sourceEl)),(e.editorEl.classList.contains("wysiwyg-hidden")?(e.editorEl.innerHTML=e.sourceEl.value,e.editorEl.classList.remove("wysiwyg-hidden"),e.sourceEl.classList.add("wysiwyg-hidden"),e.editorEl):(e.sourceEl.value=e.editorEl.innerHTML,e.editorEl.classList.add("wysiwyg-hidden"),e.sourceEl.classList.remove("wysiwyg-hidden"),e.sourceEl)).focus()},{title:"Toggle HTML source view - Switch between visual and code editing"});break;case"fullscreen":a("fullscreen","Fullscreen",()=>{var e;(e=u).wrapper.classList.contains("wysiwyg-fullscreen")?(e.wrapper.classList.remove("wysiwyg-fullscreen"),document.body.style.overflow=""):(e.wrapper.classList.add("wysiwyg-fullscreen"),document.body.style.overflow="hidden")},{title:"Enter fullscreen mode - Distraction-free editing"});break;default:i=()=>g(e),r={title:o=e},(n=document.createElement("button")).type="button",n.innerHTML=o,r.title&&(n.title=r.title),n.addEventListener("click",i),l.appendChild(n)}}),l}function h(i){let r=window.getSelection();var e=r.toString().trim();let n=0<r.rangeCount?r.getRangeAt(0):null,l=document.createElement("div"),a=(l.className="wysiwyg-dialog",l.innerHTML=`
      <h3>Insert Link</h3>
      <div class="row">
        <label>URL:</label>
        <input type="text" id="link-url" placeholder="https://example.com" value="" title="Enter the web address (URL) to link to">
      </div>
      <div class="row">
        <label>Text:</label>
        <input type="text" id="link-text" placeholder="Link text" value="${e}" title="The text that will be displayed as the clickable link">
      </div>
      <div class="row">
        <label title="Check this to open the link in a new browser tab">
          <input type="checkbox" id="link-blank"> Open in new tab
        </label>
      </div>
      <div class="row" style="text-align:right;margin-top:12px;">
        <button type="button" onclick="this.closest('.wysiwyg-dialog').remove()" title="Cancel and close without inserting link">Cancel</button>
        <button type="button" id="insert-link" style="margin-left:8px;" title="Insert the link into your content">Insert</button>
      </div>
    `,document.body.appendChild(l),l.querySelector("#link-url")),s=l.querySelector("#link-text"),d=l.querySelector("#link-blank");a.focus(),l.querySelector("#insert-link").addEventListener("click",()=>{var e=a.value.trim(),t=s.value.trim()||e,o=d.checked?' target="_blank" rel="noopener"':"";e&&(i.editorEl.focus(),n&&r.addRange(n),g("insertHTML",`<a href="${e}"${o}>${t}</a>`),i._saveSnapshot)&&i._saveSnapshot(),l.remove()}),[a,s].forEach(e=>{e.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),l.querySelector("#insert-link").click())})})}function w(p){let e=p.wrapper.querySelector(".wysiwyg-find-replace");if(e)h(p),e.remove();else{(e=document.createElement("div")).className="wysiwyg-find-replace",e.innerHTML=`
      <input type="text" id="find-input" placeholder="Find..." title="Enter text to search for in your content">
      <input type="text" id="replace-input" placeholder="Replace with..." title="Enter replacement text (optional)">
      <button type="button" id="find-next" title="Find next occurrence">Next</button>
      <button type="button" id="find-prev" title="Find previous occurrence">Prev</button>
      <button type="button" id="replace-one" title="Replace current match with new text">Replace</button>
      <button type="button" id="replace-all" title="Replace all matches in the entire document">All</button>
      <button type="button" id="close-find" title="Close find and replace panel">&times;</button>
      <span id="find-status" style="font-size:12px;color:#666;margin-left:8px;"></span>
    `,p.wrapper.appendChild(e);let t=e.querySelector("#find-input"),a=e.querySelector("#replace-input"),s=e.querySelector("#find-status"),d=(t.focus(),[]),c=-1;function h(e){e.editorEl.querySelectorAll(".wysiwyg-search-highlight").forEach(e=>{var t=e.parentNode;t.replaceChild(document.createTextNode(e.textContent),e),t.normalize()})}function o(){p.editorEl.querySelectorAll(".wysiwyg-search-highlight").forEach((e,t)=>{t===c?(e.style.cssText="background: #ff9800; color: #fff; padding: 1px 2px; border-radius: 2px; box-shadow: 0 0 3px rgba(255,152,0,0.5);",e.scrollIntoView({behavior:"smooth",block:"center"})):e.style.cssText="background: #ffeb3b; color: #000; padding: 1px 2px; border-radius: 2px;"}),0<d.length?s.textContent=c+1+" of "+d.length:s.textContent="No matches found"}function i(){var e=t.value.trim();e?(d=(a=>{if(!a)return[];h(p);for(var e,t=document.createTreeWalker(p.editorEl,NodeFilter.SHOW_TEXT,null,!1),o=[];e=t.nextNode();)o.push(e);let s=[],d=0;return o.forEach(o=>{var e,t=o.textContent,i=new RegExp(a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");let r=0;for(var n=[];null!==(e=i.exec(t));){e.index>r&&n.push(document.createTextNode(t.substring(r,e.index)));var l=document.createElement("span");l.className="wysiwyg-search-highlight",l.style.cssText="background: #ffeb3b; color: #000; padding: 1px 2px; border-radius: 2px;",l.textContent=e[0],l.dataset.matchIndex=s.length,n.push(l),s.push({element:l,text:e[0],globalIndex:d+e.index}),r=e.index+e[0].length}if(r<t.length&&n.push(document.createTextNode(t.substring(r))),1<n.length){let t=o.parentNode;n.forEach(e=>{t.insertBefore(e,o)}),t.removeChild(o)}d+=t.length}),s})(e),c=0<d.length?0:-1,o()):(h(p),d=[],c=-1,s.textContent="")}t.addEventListener("input",i),t.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),e.shiftKey?0<d.length&&(c=c<=0?d.length-1:c-1,o()):0<d.length&&(c=(c+1)%d.length,o()))}),e.querySelector("#find-next").addEventListener("click",()=>{(0<d.length?(c=(c+1)%d.length,o):i)()}),e.querySelector("#find-prev").addEventListener("click",()=>{0<d.length&&(c=c<=0?d.length-1:c-1,o())}),e.querySelector("#replace-one").addEventListener("click",function(){var e,t;0<=c&&c<d.length&&(t=a.value,(e=d[c]).element)&&e.element.parentNode&&(t=document.createTextNode(t),e.element.parentNode.replaceChild(t,e.element),p._saveSnapshot&&p._saveSnapshot(),setTimeout(()=>{i(),c>=d.length&&(c=Math.max(0,d.length-1),o())},10))}),e.querySelector("#replace-all").addEventListener("click",function(){var e=t.value.trim();let o=a.value;if(e){p.editorEl.innerHTML;var i=p.editorEl.innerText||p.editorEl.textContent||"";let t=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");e=(i.match(t)||[]).length;if(0<e){(p.editorEl.innerText||p.editorEl.textContent||"").replace(t,o);h(p);for(var r,n=document.createTreeWalker(p.editorEl,NodeFilter.SHOW_TEXT,null,!1),l=[];r=n.nextNode();)l.push(r);l.forEach(e=>{t.test(e.textContent)&&(e.textContent=e.textContent.replace(t,o))}),p._saveSnapshot&&p._saveSnapshot(),s.textContent=`Replaced ${e} occurrence`+(1!==e?"s":""),d=[],c=-1}}}),e.querySelector("#close-find").addEventListener("click",()=>{h(p),e.remove()})}}function v(e){e._buttons&&Object.keys(e._buttons).forEach(t=>{var o=e._buttons[t];if(o){let e=!1;try{switch(t){case"bold":e=document.queryCommandState("bold");break;case"italic":e=document.queryCommandState("italic");break;case"underline":e=document.queryCommandState("underline");break;case"strike":e=document.queryCommandState("strikeThrough");break;case"subscript":e=document.queryCommandState("subscript");break;case"superscript":e=document.queryCommandState("superscript");break;case"ul":e=document.queryCommandState("insertUnorderedList");break;case"ol":e=document.queryCommandState("insertOrderedList")}}catch(e){}o.setAttribute("aria-pressed",e?"true":"false"),e?(o.classList.add("active"),o._activeTooltip&&(o.title=o._activeTooltip)):(o.classList.remove("active"),o._originalTooltip&&(o.title=o._originalTooltip))}})}document.addEventListener("DOMContentLoaded",()=>{var e=document.querySelectorAll("[data-wysiwyg-v2]");0<e.length&&e.forEach(i=>{let r={};Object.keys(i.dataset).forEach(t=>{if(t.startsWith("wysiwyg")&&"wysiwygV2"!==t){var o=t.replace("wysiwyg","").toLowerCase();let e=i.dataset[t];"true"===e?e=!0:"false"===e?e=!1:isNaN(e)||(e=parseFloat(e)),r[o]=e}}),n.init(i,r)})}),e.WYSIWYG=e.WYSIWYG||{},e.WYSIWYG.v2=n,e.KriaLite=e.KriaLite||{},e.KriaLite.v2=r}})("undefined"!=typeof window?window:this);